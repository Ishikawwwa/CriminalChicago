0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team16_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS q4_results;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE q4_results(
. . . . . . . . . . . . . . . . . . . . . . .> year INT,
. . . . . . . . . . . . . . . . . . . . . . .> month INT,
. . . . . . . . . . . . . . . . . . . . . . .> domestic_crimes INT,
. . . . . . . . . . . . . . . . . . . . . . .> non_domestic_crimes INT)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ','
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION 'project/hive/warehouse/q4';
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Insert the command into the table
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.resultset.use.unique.column.names = false;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO q4_results
. . . . . . . . . . . . . . . . . . . . . . .> SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>     year,
. . . . . . . . . . . . . . . . . . . . . . .>     month,
. . . . . . . . . . . . . . . . . . . . . . .>     SUM(CASE WHEN domestic is TRUE THEN 1 ELSE 0 END) AS domestic_crimes,
. . . . . . . . . . . . . . . . . . . . . . .>     SUM(CASE WHEN domestic is FALSE THEN 1 ELSE 0 END) AS non_domestic_crimes
. . . . . . . . . . . . . . . . . . . . . . .> FROM crimes_optimized
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY year, month;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM q4_results
. . . . . . . . . . . . . . . . . . . . . . .> ORDER BY year, month;
+-------+--------+------------------+----------------------+
| year  | month  | domestic_crimes  | non_domestic_crimes  |
+-------+--------+------------------+----------------------+
| 2001  | 1      | 4708             | 33376                |
| 2001  | 2      | 4242             | 29535                |
| 2001  | 3      | 5078             | 35472                |
| 2001  | 4      | 5144             | 34933                |
| 2001  | 5      | 5411             | 36403                |
| 2001  | 6      | 5709             | 36008                |
| 2001  | 7      | 5340             | 39347                |
| 2001  | 8      | 5130             | 38899                |
| 2001  | 9      | 4757             | 36742                |
| 2001  | 10     | 4403             | 38620                |
| 2001  | 11     | 4406             | 35188                |
| 2001  | 12     | 4354             | 32488                |
| 2002  | 1      | 4636             | 33746                |
| 2002  | 2      | 4083             | 29822                |
| 2002  | 3      | 5113             | 33464                |
| 2002  | 4      | 5133             | 34890                |
| 2002  | 5      | 5906             | 36989                |
| 2002  | 6      | 6061             | 36768                |
| 2002  | 7      | 6061             | 39945                |
| 2002  | 8      | 5347             | 38855                |
| 2002  | 9      | 4930             | 37440                |
| 2002  | 10     | 4850             | 38284                |
| 2002  | 11     | 4368             | 32777                |
| 2002  | 12     | 4690             | 32473                |
| 2003  | 1      | 4223             | 32451                |
| 2003  | 2      | 3607             | 28884                |
| 2003  | 3      | 4516             | 34101                |
| 2003  | 4      | 4783             | 34973                |
| 2003  | 5      | 4767             | 36382                |
| 2003  | 6      | 4822             | 35951                |
| 2003  | 7      | 5260             | 38094                |
| 2003  | 8      | 5172             | 39021                |
| 2003  | 9      | 4461             | 36856                |
| 2003  | 10     | 4274             | 38869                |
| 2003  | 11     | 3861             | 34011                |
| 2003  | 12     | 4023             | 31572                |
| 2004  | 1      | 4189             | 30036                |
| 2004  | 2      | 4086             | 22710                |
| 2004  | 3      | 1258             | 7285                 |
| 2004  | 4      | 125              | 4050                 |
| 2004  | 5      | 3830             | 28157                |
| 2004  | 6      | 4811             | 36300                |
| 2004  | 7      | 4992             | 38240                |
| 2004  | 8      | 4724             | 38320                |
| 2004  | 9      | 4559             | 36651                |
| 2004  | 10     | 4315             | 37206                |
| 2004  | 11     | 3907             | 32928                |
| 2004  | 12     | 3825             | 30494                |
| 2005  | 1      | 3959             | 29882                |
| 2005  | 2      | 3740             | 28245                |
| 2005  | 3      | 4099             | 32803                |
| 2005  | 4      | 4583             | 34286                |
| 2005  | 5      | 4981             | 35483                |
| 2005  | 6      | 4884             | 35162                |
| 2005  | 7      | 4862             | 36942                |
| 2005  | 8      | 4417             | 37123                |
| 2005  | 9      | 4111             | 35510                |
| 2005  | 10     | 4089             | 35869                |
| 2005  | 11     | 3560             | 32414                |
| 2005  | 12     | 3437             | 29225                |
| 2006  | 1      | 4073             | 32663                |
| 2006  | 2      | 3650             | 27645                |
| 2006  | 3      | 4061             | 32910                |
| 2006  | 4      | 4502             | 31971                |
| 2006  | 5      | 4720             | 34890                |
| 2006  | 6      | 4663             | 34145                |
| 2006  | 7      | 5107             | 36429                |
| 2006  | 8      | 4617             | 35873                |
| 2006  | 9      | 4191             | 33575                |
| 2006  | 10     | 4076             | 34578                |
| 2006  | 11     | 3799             | 31765                |
| 2006  | 12     | 3842             | 30292                |
| 2007  | 1      | 3845             | 30219                |
| 2007  | 2      | 3550             | 23584                |
| 2007  | 3      | 4365             | 31981                |
| 2007  | 4      | 4367             | 31261                |
| 2007  | 5      | 4808             | 35275                |
| 2007  | 6      | 4829             | 34154                |
| 2007  | 7      | 4797             | 36187                |
| 2007  | 8      | 4593             | 35247                |
| 2007  | 9      | 4363             | 33889                |
| 2007  | 10     | 4127             | 35459                |
| 2007  | 11     | 3533             | 30885                |
| 2007  | 12     | 3748             | 27858                |
| 2008  | 1      | 3905             | 29437                |
| 2008  | 2      | 3559             | 25478                |
| 2008  | 3      | 4196             | 29774                |
| 2008  | 4      | 4203             | 31386                |
| 2008  | 5      | 4500             | 33558                |
| 2008  | 6      | 4632             | 33059                |
| 2008  | 7      | 4888             | 35592                |
| 2008  | 8      | 4723             | 35808                |
| 2008  | 9      | 4378             | 33057                |
| 2008  | 10     | 4034             | 33840                |
| 2008  | 11     | 3940             | 29613                |
| 2008  | 12     | 3490             | 25914                |
| 2009  | 1      | 4075             | 26127                |
| 2009  | 2      | 3698             | 24522                |
| 2009  | 3      | 4477             | 29197                |
| 2009  | 4      | 4367             | 28188                |
+-------+--------+------------------+----------------------+
| year  | month  | domestic_crimes  | non_domestic_crimes  |
+-------+--------+------------------+----------------------+
| 2009  | 5      | 5043             | 30188                |
| 2009  | 6      | 4941             | 29316                |
| 2009  | 7      | 4781             | 30884                |
| 2009  | 8      | 4912             | 30900                |
| 2009  | 9      | 4469             | 29390                |
| 2009  | 10     | 4154             | 29365                |
| 2009  | 11     | 4100             | 27281                |
| 2009  | 12     | 3931             | 24250                |
| 2010  | 1      | 3838             | 25314                |
| 2010  | 2      | 3518             | 21413                |
| 2010  | 3      | 4640             | 27684                |
| 2010  | 4      | 4549             | 27108                |
| 2010  | 5      | 4896             | 28494                |
| 2010  | 6      | 4863             | 27837                |
| 2010  | 7      | 4994             | 28505                |
| 2010  | 8      | 4689             | 29445                |
| 2010  | 9      | 4215             | 27657                |
| 2010  | 10     | 4184             | 28198                |
| 2010  | 11     | 3844             | 25030                |
| 2010  | 12     | 3573             | 21652                |
| 2011  | 1      | 3788             | 23348                |
| 2011  | 2      | 3248             | 18966                |
| 2011  | 3      | 4157             | 24521                |
| 2011  | 4      | 4425             | 24658                |
| 2011  | 5      | 4572             | 26994                |
| 2011  | 6      | 4645             | 27646                |
| 2011  | 7      | 4883             | 28357                |
| 2011  | 8      | 4287             | 28282                |
| 2011  | 9      | 3897             | 26011                |
| 2011  | 10     | 4005             | 26250                |
| 2011  | 11     | 3733             | 23880                |
| 2011  | 12     | 3825             | 23177                |
| 2012  | 1      | 3753             | 22441                |
| 2012  | 2      | 3468             | 20379                |
| 2012  | 3      | 4330             | 24203                |
| 2012  | 4      | 4000             | 23164                |
| 2012  | 5      | 4574             | 25493                |
| 2012  | 6      | 4671             | 26381                |
| 2012  | 7      | 4811             | 27134                |
| 2012  | 8      | 4305             | 25705                |
| 2012  | 9      | 3867             | 23863                |
| 2012  | 10     | 3682             | 24256                |
| 2012  | 11     | 3483             | 22527                |
| 2012  | 12     | 3577             | 21603                |
| 2013  | 1      | 3541             | 21816                |
| 2013  | 2      | 3094             | 18278                |
| 2013  | 3      | 3879             | 21043                |
| 2013  | 4      | 3954             | 21538                |
| 2013  | 5      | 4166             | 23793                |
| 2013  | 6      | 4277             | 23048                |
| 2013  | 7      | 4208             | 24385                |
| 2013  | 8      | 4055             | 24567                |
| 2013  | 9      | 3774             | 22521                |
| 2013  | 10     | 3433             | 21996                |
| 2013  | 11     | 3319             | 20199                |
| 2013  | 12     | 3139             | 18680                |
| 2014  | 1      | 3057             | 16813                |
| 2014  | 2      | 2577             | 15400                |
| 2014  | 3      | 3227             | 18890                |
| 2014  | 4      | 3408             | 19428                |
| 2014  | 5      | 3804             | 21003                |
| 2014  | 6      | 3855             | 21493                |
| 2014  | 7      | 3755             | 22722                |
| 2014  | 8      | 3828             | 21974                |
| 2014  | 9      | 3300             | 20511                |
| 2014  | 10     | 3199             | 20712                |
| 2014  | 11     | 3133             | 17547                |
| 2014  | 12     | 3255             | 17636                |
| 2015  | 1      | 3208             | 17448                |
| 2015  | 2      | 2561             | 13726                |
| 2015  | 3      | 3447             | 18113                |
| 2015  | 4      | 3578             | 18032                |
| 2015  | 5      | 4013             | 19557                |
| 2015  | 6      | 3808             | 19251                |
| 2015  | 7      | 3920             | 20181                |
| 2015  | 8      | 3878             | 20807                |
| 2015  | 9      | 3541             | 19455                |
| 2015  | 10     | 3244             | 19735                |
| 2015  | 11     | 3126             | 17360                |
| 2015  | 12     | 3353             | 17653                |
| 2016  | 1      | 3226             | 17149                |
| 2016  | 2      | 3056             | 15534                |
| 2016  | 3      | 3637             | 18241                |
| 2016  | 4      | 3524             | 17438                |
| 2016  | 5      | 3939             | 19393                |
| 2016  | 6      | 4075             | 19716                |
| 2016  | 7      | 3990             | 20656                |
| 2016  | 8      | 3967             | 20652                |
| 2016  | 9      | 3522             | 19713                |
| 2016  | 10     | 3479             | 19835                |
| 2016  | 11     | 3228             | 17912                |
| 2016  | 12     | 3144             | 16436                |
| 2017  | 1      | 1832             | 9525                 |
+-------+--------+------------------+----------------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 